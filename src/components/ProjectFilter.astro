---
import { getTranslations } from '../i18n/utils';

interface Props {
  lang: 'cs' | 'en';
}

const { lang } = Astro.props;
const t = getTranslations(lang);

const filters = [
  { id: 'all', label: t.projects.filterAll },
  { id: 'apps', label: t.projects.filterApps },
  { id: 'tools', label: t.projects.filterTools },
  { id: 'games', label: t.projects.filterGames },
];
---

<div class="flex flex-wrap gap-2 mb-8" role="tablist" aria-label="Filter projects">
  {filters.map((filter, index) => (
    <button
      type="button"
      role="tab"
      aria-selected={index === 0 ? 'true' : 'false'}
      data-filter={filter.id}
      class:list={[
        "filter-btn px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200",
        index === 0 ? "bg-brand-600 text-white" : "bg-surface-800 text-surface-300 hover:bg-surface-700"
      ]}
    >
      {filter.label}
    </button>
  ))}
</div>

<script>
  function initFilters() {
    const buttons = document.querySelectorAll('[data-filter]');
    const cards = document.querySelectorAll('[data-category]');
    
    buttons.forEach(btn => {
      btn.addEventListener('click', () => {
        const filter = (btn as HTMLElement).dataset.filter;
        
        buttons.forEach(b => {
          b.classList.remove('bg-brand-600', 'text-white');
          b.classList.add('bg-surface-800', 'text-surface-300');
          b.setAttribute('aria-selected', 'false');
        });
        
        btn.classList.remove('bg-surface-800', 'text-surface-300');
        btn.classList.add('bg-brand-600', 'text-white');
        btn.setAttribute('aria-selected', 'true');
        
        cards.forEach(card => {
          const category = (card as HTMLElement).dataset.category;
          if (filter === 'all' || category === filter) {
            (card as HTMLElement).style.display = '';
            (card as HTMLElement).style.opacity = '1';
          } else {
            (card as HTMLElement).style.opacity = '0';
            setTimeout(() => {
              (card as HTMLElement).style.display = 'none';
            }, 200);
          }
        });
      });
    });
  }
  
  document.addEventListener('astro:page-load', initFilters);
  initFilters();
</script>
